<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Michael Mayer">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Manual Installation - Sduino</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Sduino</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../..">Introduction</a>
                        </li>
                    
                        <li >
                            <a href="../board-manager-install/">Automatic Installation</a>
                        </li>
                    
                        <li >
                            <a href="../build-ide/">Building with the IDE</a>
                        </li>
                    
                        <li >
                            <a href="../why-stm8/">When to use an STM8S - and when not</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Manual Installation</a>
                        </li>
                    
                        <li >
                            <a href="../build-cli/">Building with a Makefile</a>
                        </li>
                    
                        <li >
                            <a href="../limitations/">Limitations</a>
                        </li>
                    
                        <li >
                            <a href="../status-todo/">Status and todo</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Libraries <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../api/migration/">API description and migration guidelines</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Print/">Print</a>
                        </li>
                    
                        <li >
                            <a href="../../api/HardwareSerial/">HardwareSerial</a>
                        </li>
                    
                        <li >
                            <a href="../../api/SPI/">SPI</a>
                        </li>
                    
                        <li >
                            <a href="../../api/I2C/">I2C</a>
                        </li>
                    
                        <li >
                            <a href="../../api/LiquidCrystal/">LiquidCrystal character LCD library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/PCD8544/">PCD8544 libray for Nokia 5110-like graphical LCDs</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Mini_SSD1306/">Mini_SSD1306 library for monochrome OLED-displays</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Stepper/">Stepper library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Servo/">Servo library</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../hardware/flashtool/">Flash tool</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/stm8blue/">Generic STM8S103 breakout board (stm8blue)</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/esp14/">ESP14: Wifi board, STM8S003</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/stm8sdiscovery/">STM8S105Discovery: Evaluation board made my ST</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../developer/ide-integration/">IDE integration</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/macro/">C preprocessor macro magic</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/pin_mapping/">Ways to define a pin mapping</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/sdcc/">Using the SDCC compiler</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/spl/">Using the SPL with SDCC and sduino</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/bare-metal-programming/">Bare metal programming on the STM8</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/performance/">Performance comparison and benchmarking</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/links/">Links and further reading</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../contact/">Contact</a>
                </li>
            
            
            
                <li >
                    <a href="../../about/">About</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../why-stm8/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../build-cli/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/tenbaht/sduino">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#manual-installation">Manual Installation</a></li>
        
            <li><a href="#linux">Linux</a></li>
        
            <li><a href="#macos">MacOS</a></li>
        
            <li><a href="#windows">Windows</a></li>
        
            <li><a href="#additional-suggestions-for-windows-users">Additional suggestions for Windows users</a></li>
        
            <li><a href="#additional-general-tweaks">Additional general tweaks</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="manual-installation">Manual Installation</h1>
<p>The recommanded way of installation is now the <a href="../board-manager-install/">automatic
installation</a> using the Arduino Board Manager.</p>
<p>The manual installation described here is only useful if you prefer a
Makefile based build over using the Arduino IDE or if you would like to help
with the development of Sduino.</p>
<p>In any case it is still possible to use the IDE.</p>
<p>For all systems start with this:</p>
<ul>
<li>Clone or download and extract the
  <a href="https://github.com/tenbaht/sduino">repository</a> to a convenient location.</li>
<li>Download the lastest <a href="http://sdcc.sourceforge.net/snap.php">SDCC snapshot
  build</a> for your system. Support for
  the STM8 improves significantly from version to version. Do not use the
  older version of SDCC that might be included in your distribution (Version
  3.6 is definitely too old).</li>
</ul>
<h2 id="linux">Linux</h2>
<h4 id="sduino-core">Sduino core</h4>
<p>Link the hardware/sduino folder of the downloaded repository to your local
Arduino hardware folder (usually in <code>~/sketchbook</code> or <code>~/Arduino</code>). Create
the hardware folder, if not already present:</p>
<pre><code class="text">    cd ~/Arduino
    mkdir hardware  # only if not already present
    ln -s [the-extracted-repository]/sduino/hardware/sduino hardware
</code></pre>

<h4 id="sdcc">SDCC</h4>
<p>Extract the downloaded <a href="http://sdcc.sourceforge.net/snap.php">SDCC archive</a>
under <code>/opt</code>:</p>
<pre><code class="text">    sudo mkdir /opt
    sudo tar xvjf ~/Downloads/sdcc-snapshot* -C /opt
</code></pre>

<p>Create a link to SDCC from the tools directory of the sduino repository
(required for IDE builds):</p>
<pre><code class="text">    cd ~/Arduino/hardware/sduino/tools
    ln -s /opt/sdcc .
</code></pre>

<h4 id="flashtools">Flashtools</h4>
<p><code>stm8flash</code> and <code>stm8gal</code> are both included as precompiled binaries in this
tools directory. Create a link <code>linux</code> to the linux tools directory that
matches your system and copy the binaries to a convient place in your path,
e.g. <code>/usr/local/bin</code>:</p>
<pre><code class="text">    ln -s linux64 linux
    cp -av linux/* /usr/local/bin
</code></pre>

<p><code>make</code> and libusb-1.0 (needed by stm8flash) are part of the standard
repository for any Linux distribution. Example for Debian-type systems (like
Ubuntu, Mint, Elementary etc.):</p>
<pre><code class="text">    sudo apt-get install make libusb-1.0-0
</code></pre>

<p>Finally, add a udev rule in order to access the USB port for your flash
tool. Save this as root in in <code>/etc/udev/rules.d/99-stlink.rules</code>:</p>
<pre><code class="text">    # ST-Link/V2 programming adapter

    # ST-Link V1, if using a STM8S discovery board
    # important: It needs a special entry in /etc/modprobe.d
    ATTR{idVendor}==&quot;0483&quot;, ATTR{idProduct}==&quot;3744&quot;, MODE=&quot;0666&quot;, GROUP=&quot;plugdev&quot;

    # ST-Link/V2, the china adapter with the green plastic housing
    ATTR{idVendor}==&quot;0483&quot;, ATTR{idProduct}==&quot;3748&quot;, MODE=&quot;0666&quot;, GROUP=&quot;plugdev&quot;
</code></pre>

<p>Using the STM8S-Discovery board as a flash programmer requires a <a href="../../hardware/stm8sdiscovery#usage-with-linux-and-stm8flash">special
modprobe configuration
entry</a>.</p>
<h2 id="macos">MacOS</h2>
<p>Quite similar to the Linux install. <a href="https://brew.sh/">Install Homebrew</a> if
you haven't done it yet, than install make and unpack the sdcc snapshot:</p>
<pre><code class="text">    brew make
    mkdir /opt
    tar xvjf sdcc-snapshot* -C /opt
</code></pre>

<p>Adopt the other steps from the Linux install. The arduino hardware folder is
in your Documents folder at <code>/Users/&lt;username&gt;/Documents/Arduino/hardware</code>.</p>
<p>Not sure about stm8flash, I didn't try it. Have a look at the <a href="https://github.com/vdudouyt/stm8flash">stm8flash
repository</a>. It would be great if
someone could summarize the procedure and send it to me together with a
compiled binary for the repository.</p>
<h2 id="windows">Windows</h2>
<p>Same idea again, but additionally we need to install a minimal MinGW command
line environment with tools needed by make and the Makefile. Let's start
with that:</p>
<h4 id="install-msys2">Install Msys2</h4>
<ul>
<li>Download and run the installer from <a href="http://www.msys2.org">http://www.msys2.org</a></li>
<li>Install make: <code>pacman -S make</code></li>
<li>define the environment variable <code>HOME</code> in the windows settings as
  <code>%USERPROFILE%</code></li>
<li>close and re-open the terminal window</li>
</ul>
<p>Now we can start working. </p>
<h4 id="install-the-core-files-and-sdcc">Install the core files and SDCC</h4>
<p>Thanks to the running bash the remaining steps are the same as for Linux,
the only difference is your Arduino folder in <code>Documents/Arduino</code>.</p>
<h4 id="st-link-stm8flash">ST-Link, stm8flash</h4>
<p>If not already done, install the ST-Link driver from the ST website for
hardware access.</p>
<p>You are not bound to <code>stm8flash</code>, you can use the regular flash tool by ST
if you prefer.</p>
<p><code>stm8flash</code> and <code>libusb-1.0.dll</code> are both included as precompiled binaries
in the tools directory. Copy or link them to a directory in your path:</p>
<pre><code class="text">    cd hardware/sduino/tools/win
    cp -av stm8flash.exe libusb-1.0.dll /bin
</code></pre>

<h4 id="limitations">Limitations</h4>
<p>Keep the <a href="../limitations#known-problems-using-windows">known problems using
Windows</a> in mind.</p>
<h2 id="additional-suggestions-for-windows-users">Additional suggestions for Windows users</h2>
<h3 id="get-a-better-console">Get a better console</h3>
<p>There is no good reason to keep suffering from the stock Windows terminal
window. Installing e.g.
<a href="https://sourceforge.net/projects/console/">console2</a> will make your life on
the command line so much more enjoyable.</p>
<h3 id="installation-shortcut">Installation shortcut</h3>
<p>Instead of installing mingw and sdcc from scratch you can</p>
<ul>
<li>manually unpack the latest board manager tools archive
  <a href="https://github.com/tenbaht/sduino/releases">sduino-tools_mingw32*.tar.bz2</a>
  into the hardware/sduino/tools folder</li>
<li>set <code>c:\sdcc</code> as a link to the sdcc folder</li>
<li>Add <code>tools/win</code> and <code>c:\sdcc\bin</code> to your `%PATH%</li>
</ul>
<p>As a workaround for unpacking a tar.bz2 file (again, Windows is lacking even
the most basic tools...) you could use the board manager and copy the needed
files out of Appdata/Arduino/packages/sduino. But mind the slightly
different directory layout and don't forget to remove the package again
after you are done copying. Otherwise your are going to use different
versions of the sduino core for IDE and Makefile builds. Confusion would be
guaranteed!</p>
<h3 id="using-mingw-instead-of-msys2">Using MinGW instead of msys2</h3>
<p>I used to recommand using MinGW, because it is more compact than msys2. But
installation is a little more complicated. If you are like me and prefer
minimal solutions over big packages:</p>
<ol>
<li>Check the
   <a href="http://www.mingw.org/wiki/Getting_Started">MinGW Installation Notes</a></li>
<li>Download and run
   <a href="https://sourceforge.net/projects/mingw/files/Installer/">mingw-get-setup.exe</a>
   You can safely deactivate the graphical option.</li>
<li>Add <code>;c:\mingw\bin;c:\mingw\msys\1.0\bin</code> to the end of your <code>%PATH%</code></li>
<li>Open a command line and install msys-base: <code>mingw-get install msys-base</code></li>
<li>Now <code>ls</code> or <code>make</code> should work.</li>
<li>Start a bash: <code>bash</code></li>
<li>For now you might want to set the <code>HOME</code> variable: <code>export
   HOME=/c/Users/&lt;yourusername&gt;</code>. In the long run this goes in <code>.bashrc</code>.</li>
</ol>
<h2 id="additional-general-tweaks">Additional general tweaks</h2>
<p>The full SDCC archive includes support for many CPUs, but you only need the
stm8. You can safely delete all the files related to the PIC CPUs in the
<code>pic*</code> and <code>non-free</code> directories. That safes more than 90% of the used disk
space and leaves only 20MB out of 240MB.</p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
	</footer>


        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>